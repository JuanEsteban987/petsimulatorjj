<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juego de Programaci√≥n - C√≥digo F√°cil</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }
        
        body {
            background: #1a1e2a;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        
        .game-container {
            display: flex;
            gap: 20px;
            max-width: 1200px;
            width: 100%;
        }
        
        /* Panel izquierdo - Canvas del juego */
        .game-area {
            flex: 2;
            background: #0f1219;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 0 #090b10;
        }
        
        canvas {
            width: 100%;
            height: 400px;
            background: #1e2433;
            border-radius: 8px;
            display: block;
            border: 3px solid #2d3445;
        }
        
        /* Panel derecho - Control y c√≥digo */
        .code-panel {
            flex: 1;
            background: #0f1219;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 0 #090b10;
            color: #fff;
        }
        
        .code-input {
            margin-bottom: 20px;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            background: #1e2433;
            border: 3px solid #2d3445;
            border-radius: 8px;
            color: #b4e1fd;
            font-size: 14px;
            padding: 12px;
            resize: none;
            font-family: 'Courier New', monospace;
            line-height: 1.5;
        }
        
        textarea:focus {
            outline: none;
            border-color: #4fa3e3;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        button {
            flex: 1;
            background: #2d3445;
            border: none;
            border-bottom: 4px solid #1a1e2a;
            color: white;
            font-size: 16px;
            font-weight: bold;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.1s;
            font-family: 'Courier New', monospace;
        }
        
        button:hover {
            background: #3d455a;
            border-bottom-width: 2px;
            transform: translateY(2px);
        }
        
        button.execute {
            background: #4fa3e3;
            border-bottom-color: #2d6ca3;
        }
        
        button.execute:hover {
            background: #6bb5f0;
        }
        
        /* Manual de comandos */
        .manual {
            background: #1e2433;
            border-radius: 8px;
            padding: 15px;
            border: 3px solid #2d3445;
        }
        
        .manual h3 {
            margin: 0 0 15px 0;
            color: #b4e1fd;
            font-size: 18px;
            text-align: center;
            border-bottom: 2px solid #2d3445;
            padding-bottom: 8px;
        }
        
        .command-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .command-item {
            background: #0f1219;
            border-radius: 6px;
            padding: 10px;
        }
        
        .command-name {
            color: #ffb86b;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .command-example {
            background: #2d3445;
            padding: 6px;
            border-radius: 4px;
            color: #b4e1fd;
            font-size: 13px;
            margin: 5px 0;
        }
        
        .command-desc {
            color: #9aa5b8;
            font-size: 12px;
        }
        
        .object-list {
            margin-top: 15px;
            background: #0f1219;
            border-radius: 6px;
            padding: 10px;
        }
        
        .object-title {
            color: #ffb86b;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .object-item {
            background: #1e2433;
            padding: 5px 8px;
            border-radius: 4px;
            margin-bottom: 5px;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .object-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            display: inline-block;
        }
        
        .object-shape {
            width: 12px;
            height: 12px;
            display: inline-block;
            margin-left: auto;
        }
        
        .error-message {
            background: #d45b5b;
            color: white;
            padding: 8px;
            border-radius: 4px;
            margin: 10px 0;
            font-size: 13px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- √Årea del juego -->
        <div class="game-area">
            <canvas id="gameCanvas" width="600" height="400"></canvas>
        </div>
        
        <!-- Panel de c√≥digo -->
        <div class="code-panel">
            <div class="code-input">
                <textarea id="codeEditor" placeholder="Escribe tu c√≥digo aqu√≠...">// Comandos disponibles:
// mover:"objeto":"pasos"
// sprite:"objeto":"forma(cubo/circulo)":"color"
// crearobjeto:"nombre"

// Ejemplo:
crearobjeto:"player"
sprite:"player":"circulo":"#FF5733"
mover:"player":"50"</textarea>
            </div>
            
            <div class="button-group">
                <button class="execute" onclick="executeCode()">‚ñ∂ EJECUTAR</button>
                <button onclick="resetGame()">‚Ü∫ REINICIAR</button>
            </div>
            
            <div id="errorDisplay" class="error-message"></div>
            
            <!-- Manual de comandos -->
            <div class="manual">
                <h3>üìö MANUAL DE COMANDOS</h3>
                <div class="command-list">
                    <div class="command-item">
                        <div class="command-name">CREAR OBJETO</div>
                        <div class="command-example">crearobjeto:"nombre"</div>
                        <div class="command-desc">Crea un nuevo objeto con el nombre especificado</div>
                    </div>
                    
                    <div class="command-item">
                        <div class="command-name">SPRITE</div>
                        <div class="command-example">sprite:"objeto":"forma":"color"</div>
                        <div class="command-desc">Define la forma (cubo/circulo) y color del objeto</div>
                    </div>
                    
                    <div class="command-item">
                        <div class="command-name">MOVIMIENTO</div>
                        <div class="command-example">mover:"objeto":"pasos"</div>
                        <div class="command-desc">Mueve el objeto hacia la derecha (pasos en p√≠xeles)</div>
                    </div>
                </div>
                
                <!-- Objetos activos -->
                <div class="object-list" id="objectList">
                    <div class="object-title">üì¶ OBJETOS ACTIVOS</div>
                    <div id="objectsContainer">
                        <!-- Se llena din√°micamente -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuraci√≥n del canvas
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Objetos del juego
        let gameObjects = {};
        let nextPosition = 50; // Posici√≥n inicial para nuevos objetos
        
        // Colores predefinidos para ejemplos
        const colorExamples = {
            'rojo': '#FF5733',
            'azul': '#3398FF',
            'verde': '#33FF57',
            'amarillo': '#F1C40F',
            'morado': '#9B59B6'
        };
        
        // Funci√≥n para dibujar en el canvas
        function drawGame() {
            // Limpiar canvas
            ctx.fillStyle = '#1e2433';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Dibujar grid de referencia
            ctx.strokeStyle = '#2d3445';
            ctx.lineWidth = 1;
            for(let i = 0; i < canvas.width; i += 50) {
                ctx.beginPath();
                ctx.strokeStyle = '#2d3445';
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            
            // Dibujar cada objeto
            Object.keys(gameObjects).forEach(key => {
                const obj = gameObjects[key];
                
                // Guardar contexto
                ctx.save();
                
                // Aplicar transformaciones
                ctx.translate(obj.x, obj.y);
                
                // Dibujar seg√∫n la forma
                ctx.fillStyle = obj.color;
                
                if (obj.shape === 'circulo') {
                    ctx.beginPath();
                    ctx.arc(0, 0, 20, 0, Math.PI * 2);
                    ctx.fill();
                } else { // cubo (cuadrado)
                    ctx.fillRect(-20, -20, 40, 40);
                }
                
                // Dibujar borde
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;
                if (obj.shape === 'circulo') {
                    ctx.beginPath();
                    ctx.arc(0, 0, 20, 0, Math.PI * 2);
                    ctx.stroke();
                } else {
                    ctx.strokeRect(-20, -20, 40, 40);
                }
                
                // Dibujar nombre del objeto
                ctx.restore();
                ctx.save();
                ctx.font = 'bold 12px Courier New';
                ctx.fillStyle = '#ffffff';
                ctx.shadowColor = '#000000';
                ctx.shadowBlur = 4;
                ctx.fillText(obj.name, obj.x - 30, obj.y - 30);
                ctx.restore();
            });
        }
        
        // Actualizar lista de objetos en el panel
        function updateObjectList() {
            const container = document.getElementById('objectsContainer');
            if (!container) return;
            
            let html = '';
            Object.keys(gameObjects).forEach(key => {
                const obj = gameObjects[key];
                const colorPreview = `<span class="object-color" style="background: ${obj.color};"></span>`;
                const shapeIcon = obj.shape === 'circulo' ? '‚ö™' : '‚¨ú';
                
                html += `<div class="object-item">
                    ${colorPreview}
                    <span style="flex:1;">${obj.name}</span>
                    <span class="object-shape">${shapeIcon}</span>
                </div>`;
            });
            
            if (html === '') {
                html = '<div style="color: #666; text-align: center; padding: 10px;">No hay objetos</div>';
            }
            
            container.innerHTML = html;
        }
        
        // Procesar comando
        function processCommand(command) {
            // Limpiar espacios y saltos de l√≠nea
            command = command.trim();
            
            // Ignorar comentarios y l√≠neas vac√≠as
            if (command === '' || command.startsWith('//')) return true;
            
            // Separar comando y par√°metros
            const colonIndex = command.indexOf(':');
            if (colonIndex === -1) {
                throw new Error(`Comando inv√°lido: ${command} (debe usar : para separar)`);
            }
            
            const cmd = command.substring(0, colonIndex).toLowerCase();
            const params = command.substring(colonIndex + 1).split(':').map(p => 
                p.trim().replace(/^"|"$/g, '') // Quitar comillas
            );
            
            console.log('Procesando:', cmd, params);
            
            switch(cmd) {
                case 'crearobjeto':
                    if (params.length < 1) throw new Error('crearobjeto necesita un nombre');
                    const name = params[0];
                    if (gameObjects[name]) throw new Error(`El objeto "${name}" ya existe`);
                    
                    gameObjects[name] = {
                        name: name,
                        x: nextPosition,
                        y: 200,
                        shape: 'cubo',
                        color: '#FFFFFF'
                    };
                    nextPosition += 80;
                    if (nextPosition > 500) nextPosition = 50;
                    break;
                    
                case 'sprite':
                    if (params.length < 3) throw new Error('sprite necesita: objeto, forma, color');
                    const spriteObj = params[0];
                    const shape = params[1].toLowerCase();
                    let color = params[2];
                    
                    if (!gameObjects[spriteObj]) throw new Error(`Objeto "${spriteObj}" no encontrado`);
                    if (shape !== 'cubo' && shape !== 'circulo') {
                        throw new Error('Forma debe ser "cubo" o "circulo"');
                    }
                    
                    // Verificar si es un color predefinido
                    if (colorExamples[color]) {
                        color = colorExamples[color];
                    }
                    
                    gameObjects[spriteObj].shape = shape;
                    gameObjects[spriteObj].color = color;
                    break;
                    
                case 'mover':
                    if (params.length < 2) throw new Error('mover necesita: objeto, pasos');
                    const moveObj = params[0];
                    const steps = parseInt(params[1]);
                    
                    if (!gameObjects[moveObj]) throw new Error(`Objeto "${moveObj}" no encontrado`);
                    if (isNaN(steps)) throw new Error('Pasos debe ser un n√∫mero');
                    
                    gameObjects[moveObj].x += steps;
                    
                    // Mantener dentro del canvas
                    if (gameObjects[moveObj].x < 30) gameObjects[moveObj].x = 30;
                    if (gameObjects[moveObj].x > canvas.width - 30) gameObjects[moveObj].x = canvas.width - 30;
                    break;
                    
                default:
                    throw new Error(`Comando desconocido: "${cmd}"`);
            }
            
            return true;
        }
        
        // Ejecutar c√≥digo
        function executeCode() {
            const code = document.getElementById('codeEditor').value;
            const lines = code.split('\n');
            const errorDisplay = document.getElementById('errorDisplay');
            
            errorDisplay.style.display = 'none';
            
            // Procesar cada l√≠nea
            for (let i = 0; i < lines.length; i++) {
                try {
                    processCommand(lines[i]);
                } catch (error) {
                    errorDisplay.textContent = `Error en l√≠nea ${i + 1}: ${error.message}`;
                    errorDisplay.style.display = 'block';
                    console.error('Error:', error);
                    break;
                }
            }
            
            // Actualizar visualizaci√≥n
            drawGame();
            updateObjectList();
        }
        
        // Reiniciar juego
        function resetGame() {
            gameObjects = {};
            nextPosition = 50;
            
            // Crear objetos de ejemplo
            gameObjects['player'] = {
                name: 'player',
                x: 50,
                y: 150,
                shape: 'circulo',
                color: '#FF5733'
            };
            
            gameObjects['caja'] = {
                name: 'caja',
                x: 130,
                y: 250,
                shape: 'cubo',
                color: '#3398FF'
            };
            
            gameObjects['target'] = {
                name: 'target',
                x: 300,
                y: 200,
                shape: 'cubo',
                color: '#F1C40F'
            };
            
            nextPosition = 400;
            
            drawGame();
            updateObjectList();
            
            // Actualizar editor con c√≥digo de ejemplo
            document.getElementById('codeEditor').value = 
                '// ¬°Bienvenido al juego de programaci√≥n!\n' +
                '// Prueba estos comandos:\n' +
                'crearobjeto:"nuevo"\n' +
                'sprite:"nuevo":"circulo":"verde"\n' +
                'mover:"nuevo":"100"\n\n' +
                '// Tambi√©n puedes mover objetos existentes:\n' +
                'mover:"player":"50"\n' +
                'sprite:"caja":"cubo":"morado"';
        }
        
        // Inicializar
        window.onload = function() {
            resetGame();
            
            // Ejemplos de c√≥digo r√°pido
            const exampleCommands = [
                'mover:"player":"100"',
                'mover:"caja":"50"',
                'sprite:"target":"circulo":"rojo"'
            ];
            
            console.log('Juego de programaci√≥n iniciado!');
        };
        
        // Hacer funciones globales
        window.executeCode = executeCode;
        window.resetGame = resetGame;
    </script>
</body>
</html>
